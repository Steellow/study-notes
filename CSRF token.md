<-- [[OAuth grant types]]  
ðŸŒ https://portswigger.net/web-security/csrf/tokens
# CSRF tokens
## What are CSRF tokens?
- Unique, secret, unpredictable value generated by server-side app
- Transmitted to client in a way that it's included in a subsequent HTTP req made by client
- When later reqs are made, server validates that they include expected token

## How should CSRF tokens be generated?
- Should be strongly unpredictable
- Should be made with croptographic strength pseudo-random number generator (PRNG)
	- Seeded with timestamp + static secret

## How should CSRF tokens be transmitted?
- Should be treated as secrets, and be handled in secure manner
- Effective strategy is to transmit the token to client in a hidden field of HTML form
	- Using POST method
	- `<input type="hidden" name="csrf-token" value="CIwNZNlR4XbisJF39I8yWnWX9wX4WFoz" />`
	- The field should be placed as early as possible in the HTML
		- Ideally before any non-hidden inputs
- Alternative strategy is to place token into URL query string
	- Less safe, because the string:
		- Is logged in various locations on client and server
		- Is liable to bo sent to 3rd parties within the HTTP Referer header
		- Can be displayed on user's browser
- Some apps transming CSRF tokens with custom req header
	- Even more secure, because browser don't normally allow custom headers to be sent to cross-domain
	- However this limits client to making CSRF-protected reqs using XHR (as opposed to HTML forms)
	- Can also be deemed over-complicated
- CSRF tokens shouldn't be transmitted over cookies

## How should CSRF tokens be validated?
- When it's generated, it should be stored server-side within the user's session data
- When reqs are made, should be compared to the one stored in user's session